package patterns

import (
	"strings"
)

type PatternCell struct {
	X uint16 `json:"x"`
	Y uint16 `json:"y"`
}

// Pattern represents a Conway's Game of Life pattern
type Pattern struct {
	Name    string        `json:"name"`
	Cells   []PatternCell `json:"cells"`
	CenterX uint16        `json:"center_x"`
	CenterY uint16        `json:"center_y"`
}

var Patterns map[string]*Pattern

func init() {
	Patterns = map[string]*Pattern{
		"119P4H1V0": parsePattern("119P4H1V0", `
|.................................O.|
|................O...............O.O|
|......O.O......O.....OO........O...|
|......O....O....O.OOOOOO....OO.....|
|......O.OOOOOOOO..........O..O.OOO.|
|.........O.....O.......OOOO....OOO.|
|....OO.................OOO.O.......|
|.O..OO.......OO........OO..........|
|.O..O..............................|
|O..................................|
|.O..O..............................|
|.O..OO.......OO........OO..........|
|....OO.................OOO.O.......|
|.........O.....O.......OOOO....OOO.|
|......O.OOOOOOOO..........O..O.OOO.|
|......O....O....O.OOOOOO....OO.....|
|......O.O......O.....OO........O...|
|................O...............O.O|
|.................................O.|
`),
		"295P5H1V1": parsePattern("295P5H1V1", `
|.............OO.....................................|
|.....OO....OO.O.O...................................|
|....OOO....OOOO.....................................|
|...OO......OO.....O.................................|
|..OO..OO...O..O..O..................................|
|.OO.....O.......O..OO...............................|
|.OO.O...OOOO........................................|
|....O...OO..OO.O....................................|
|.....OOO....O.O.....................................|
|......OO...OO..O....................................|
|......O.....O.......................................|
|.OOOO.O..O..O...O...................................|
|.OOO...OOOOO..OOOOOOO.O.............................|
|O.O....O..........O..OO.............................|
|OOO.O...O...O.....OOO...............................|
|.......O.O..O.......OO..............................|
|.O...O.....OO........OO..O.O........................|
|....O.......O........OOO.O.OOO......................|
|...O........OOO......O....O.........................|
|.....O......O.O.....O.O.............................|
|.....O......O.OO...O....O...........................|
|.............O.OOOO...O.....O..O....................|
|............OO..OO.O.O...O.OOO......................|
|.................O......O..OOO...OOO................|
|....................O..O......OO....................|
|................OO....O..O..........OO..............|
|..................O.............O...O...............|
|................OO....OO........O...................|
|.................O...OOO........O.O.O.O.............|
|.................O....OO........O.....OO............|
|........................O........O..OOO.............|
|.....................O..O........O........O.........|
|..........................OOOO........OO...O........|
|.......................O......OO......OO...O........|
|.......................O....O............O..........|
|.......................O...............O............|
|.........................OO.O.O.......O..O..........|
|.........................O....O.........OOO.........|
|............................OOO.OO..O...O...O.OO....|
|.............................O..OO.O.....O...O..O...|
|.....................................OO..O...O......|
|..................................O.OO.OO.O..OO...O.|
|...............................O.....O...O.......O.O|
|................................OO............OO...O|
|......................................O.......OO....|
|.......................................OOO...OO..O..|
|......................................O..O.OOO......|
|......................................O....OO.......|
|.......................................O............|
|..........................................O..O......|
|.........................................O..........|
|..........................................OO........|
`),
		"2c3-wire": parsePattern("2c/3 Wire", `
|......O..O.......................................|
|....OOOOOO.......................................|
|...O.............................................|
|...O..OOOOOO.....................................|
|OO.O.O.O....O....................................|
|OO.O.O.OOOOOO....................................|
|....OO.O.......O.................................|
|.......O..OOOOOO.................................|
|.......O.O.......................................|
|......OO.O..OOOOOO...............................|
|.........O.O......O..............................|
|.........O.O..OOOOO..............................|
|..........OO.O.......O...........................|
|.............O..OOOOOO...........................|
|.............O.O.................................|
|............OO.O..OOOOOO.........................|
|...............O.O......O........................|
|...............O.O..OOOOO........................|
|................OO.O.......O.....................|
|...................O..OOOOOO.....................|
|...................O.O...........................|
|..................OO.O..OOOOOO...................|
|.....................O.O......O..................|
|.....................O.O..OOOOO..................|
|......................OO.O.......O...............|
|.........................O..OOOOOO...............|
|.........................O.O.....................|
|........................OO.O..OOOOOO.............|
|...........................O.O......O............|
|...........................O.O..OOOOO............|
|............................OO.O.......O.........|
|...............................O..OOOOOO.........|
|...............................O.O...............|
|..............................OO.O..OOOOOO.......|
|.................................O.O......O......|
|.................................O.O..OOOOO......|
|..................................OO.O.......O...|
|.....................................O..OOOOOO...|
|.....................................O.O.........|
|....................................OO.O..OOOOOO.|
|.......................................O.O......O|
|.......................................O.O..OOO.O|
|........................................OO.O...O.|
|...........................................O..O..|
|...........................................O.O...|
|..........................................OO.O.O.|
|..............................................OO.|
`),
		"4-boats": parsePattern("4 Boats", `
|...O....|
|..O.O...|
|.O.OO...|
|O.O..OO.|
|.OO..O.O|
|...OO.O.|
|...O.O..|
|....O...|
`),
		"44P5H2V0": parsePattern("44P5H2V0", `
|....O.....O....|
|...OOO...OOO...|
|..O..O...O..O..|
|.OOO.......OOO.|
|..O.O.....O.O..|
|....OO...OO....|
|O....O...O....O|
|.....O...O.....|
|OO...O...O...OO|
|..O..O...O..O..|
|....O.....O....|
`),
		"acorn": parsePattern("Acorn", `
|.O.....|
|...O...|
|OO..OOO|
`),
		"arm": parsePattern("Arm", `
|............OOO............|
|...........O...............|
|..........OO...............|
|....O.OO..OO..OOO..........|
|...OO.OO.OO.....O....OO....|
|..O..OO...O.OO....OO.OO....|
|........OOOO......OO...O...|
|....O.O.OO........OO.......|
|......O....................|
|...OO......................|
|..OO..O....................|
|....OOO.OO.................|
|O..O.....OOO...............|
|.O.OOOO.O...O..............|
|........OO....O......O.....|
|.........O....OO....OO.OOO.|
|........O...O..OO..OO.....O|
|..........O..O.O..O.....OO.|
|...........O.OOO....O......|
|............OOO..OOO.O.....|
|...........OO...OOO........|
|..................O..O.....|
|...................O.......|
`),
		"baker": parsePattern("Baker", `
|..............OO|
|.............O.O|
|............O...|
|...........O....|
|..........O.....|
|.........O......|
|........O.......|
|.......O........|
|......O.........|
|.....O..........|
|....O...........|
|...O............|
|OOO.............|
|.O..............|
`),
		"biclock": parsePattern("Biclock", `
|..O....|
|OO.....|
|..OO...|
|.O...O.|
|...OO..|
|.....OO|
|....O..|
`),
		"bi-gun": parsePattern("Bi-Gun", `
|...........O......................................|
|..........OO......................................|
|.........OO.......................................|
|..........OO..OO..................................|
|......................................O...........|
|......................................OO........OO|
|.......................................OO.......OO|
|..........OO..OO..................OO..OO..........|
|OO.......OO.......................................|
|OO........OO......................................|
|...........O......................................|
|..................................OO..OO..........|
|.......................................OO.........|
|......................................OO..........|
|......................................O...........|
`),
		"blinker-puffer": parsePattern("Blinker Puffer", `
|...O.....|
|.O...O...|
|O........|
|O....O...|
|OOOOO....|
|.........|
|.........|
|.........|
|.OO......|
|OO.OOO...|
|.OOOO....|
|..OO.....|
|.........|
|.....OO..|
|...O....O|
|..O......|
|..O.....O|
|..OOOOOO.|
`),
		"copperhead": parsePattern("Copperhead", `
|..OOOO..|
|........|
|..O..O..|
|.O.OO.O.|
|.O....O.|
|........|
|.O....O.|
|.OO..OO.|
|.OOOOOO.|
|..O..O..|
|...OO...|
|...OO...|
`),
		"demultiplexer": parsePattern("Demultiplexer", `
|...........................O.....|
|........OO.................O.O...|
|.........O.................OO....|
|.........O.O.....................|
|..........OO.....................|
|.......................OO........|
|.......................O.O.......|
|........................O........|
|.................................|
|.................................|
|.............................OO..|
|..........O..................O.O.|
|..........O.O..................O.|
|..........OOO............OO....OO|
|............O............O.O.....|
|...........................O.....|
|...........................OO....|
|.................................|
|.................................|
|..OO.............................|
|.O.O.............................|
|.O...............................|
|OO...............................|
`),
		"glider": parsePattern("Glider", `
|..O|
|O.O|
|.OO|
`),
		"gosper-glider-gun": parsePattern("Gosper Glider Gun", `
|........................O...........|
|......................O.O...........|
|............OO......OO............OO|
|...........O...O....OO............OO|
|OO........O.....O...OO..............|
|OO........O...O.OO....O.O...........|
|..........O.....O.......O...........|
|...........O...O....................|
|............OO......................|
`),
		"heavy-weight-spaceship": parsePattern("Heavy Weight Spaceship", `
|..OO...|
|O....O.|
|......O|
|O.....O|
|.OOOOOO|
`),
		"light-weight-spaceship": parsePattern("Light Weight Spaceship", `
|.OOOO|
|O...O|
|....O|
|O..O.|
`),
		"middle-weight-spaceship": parsePattern("Middle Weight Spaceship", `
|..O...|
|O...O.|
|.....O|
|O....O|
|.OOOOO|
`),
		"noahs-ark": parsePattern("Noah's Ark", `
|..........O.O..|
|.........O.....|
|..........O..O.|
|............OOO|
|...............|
|...............|
|...............|
|...............|
|...............|
|.O.............|
|O.O............|
|...............|
|O..O...........|
|..OO...........|
|...O...........|
`),
		"pentadecathlon": parsePattern("Pentadecathlon", `
|..O....O..|
|OO.OOOO.OO|
|..O....O..|
`),
		"pi-heptomino": parsePattern("pi-Heptomino", `
|OOO|
|O.O|
|O.O|
`),
		"queen-bee-shuttle": parsePattern("Queen Bee Shuttle", `
|.........O............|
|.......O.O............|
|......O.O.............|
|OO...O..O.............|
|OO....O.O.............|
|.......O.O........OO..|
|.........O........O.O.|
|....................O.|
|....................OO|
`),
		"r-pentomino": parsePattern("r-Pentomino", `
|.OO|
|OO.|
|.O.|
`),
		"switch-engine": parsePattern("Switch Engine", `
|.O.O..|
|O.....|
|.O..O.|
|...OOO|
`),
	}
}

// parsePattern parses a pattern string like the cs template literal in JavaScript
func parsePattern(name, pattern string) *Pattern {
	lines := strings.Split(pattern, "\n")
	var cells []PatternCell

	for y, line := range lines {
		// Skip empty lines
		if len(line) == 0 {
			continue
		}

		for x, char := range line {
			if char == 'O' {
				cells = append(cells, PatternCell{X: uint16(x), Y: uint16(y)})
			}
		}
	}

	return &Pattern{
		Name:    name,
		Cells:   cells,
		CenterX: uint16(len(lines[1])-1) / 2,
		CenterY: uint16(len(lines)-1) / 2,
	}
}

//
// // GetPatterns returns a map of all available patterns
// func GetPatterns() Patterns {
// 	return map[string]Pattern{
// 		"119P4H1V0": parsePattern("119P4H1V0", `
// |.................................O.|
// |................O...............O.O|
// |......O.O......O.....OO........O...|
// |......O....O....O.OOOOOO....OO.....|
// |......O.OOOOOOOO..........O..O.OOO.|
// |.........O.....O.......OOOO....OOO.|
// |....OO.................OOO.O.......|
// |.O..OO.......OO........OO..........|
// |.O..O..............................|
// |O..................................|
// |.O..O..............................|
// |.O..OO.......OO........OO..........|
// |....OO.................OOO.O.......|
// |.........O.....O.......OOOO....OOO.|
// |......O.OOOOOOOO..........O..O.OOO.|
// |......O....O....O.OOOOOO....OO.....|
// |......O.O......O.....OO........O...|
// |................O...............O.O|
// |.................................O.|
// `),
// 		"295P5H1V1": parsePattern("295P5H1V1", `
// |.............OO.....................................|
// |.....OO....OO.O.O...................................|
// |....OOO....OOOO.....................................|
// |...OO......OO.....O.................................|
// |..OO..OO...O..O..O..................................|
// |.OO.....O.......O..OO...............................|
// |.OO.O...OOOO........................................|
// |....O...OO..OO.O....................................|
// |.....OOO....O.O.....................................|
// |......OO...OO..O....................................|
// |......O.....O.......................................|
// |.OOOO.O..O..O...O...................................|
// |.OOO...OOOOO..OOOOOOO.O.............................|
// |O.O....O..........O..OO.............................|
// |OOO.O...O...O.....OOO...............................|
// |.......O.O..O.......OO..............................|
// |.O...O.....OO........OO..O.O........................|
// |....O.......O........OOO.O.OOO......................|
// |...O........OOO......O....O.........................|
// |.....O......O.O.....O.O.............................|
// |.....O......O.OO...O....O...........................|
// |.............O.OOOO...O.....O..O....................|
// |............OO..OO.O.O...O.OOO......................|
// |.................O......O..OOO...OOO................|
// |....................O..O......OO....................|
// |................OO....O..O..........OO..............|
// |..................O.............O...O...............|
// |................OO....OO........O...................|
// |.................O...OOO........O.O.O.O.............|
// |.................O....OO........O.....OO............|
// |........................O........O..OOO.............|
// |.....................O..O........O........O.........|
// |..........................OOOO........OO...O........|
// |.......................O......OO......OO...O........|
// |.......................O....O............O..........|
// |.......................O...............O............|
// |.........................OO.O.O.......O..O..........|
// |.........................O....O.........OOO.........|
// |............................OOO.OO..O...O...O.OO....|
// |.............................O..OO.O.....O...O..O...|
// |.....................................OO..O...O......|
// |..................................O.OO.OO.O..OO...O.|
// |...............................O.....O...O.......O.O|
// |................................OO............OO...O|
// |......................................O.......OO....|
// |.......................................OOO...OO..O..|
// |......................................O..O.OOO......|
// |......................................O....OO.......|
// |.......................................O............|
// |..........................................O..O......|
// |.........................................O..........|
// |..........................................OO........|
// `),
// 		"2c3-wire": parsePattern("2c/3 Wire", `
// |......O..O.......................................|
// |....OOOOOO.......................................|
// |...O.............................................|
// |...O..OOOOOO.....................................|
// |OO.O.O.O....O....................................|
// |OO.O.O.OOOOOO....................................|
// |....OO.O.......O.................................|
// |.......O..OOOOOO.................................|
// |.......O.O.......................................|
// |......OO.O..OOOOOO...............................|
// |.........O.O......O..............................|
// |.........O.O..OOOOO..............................|
// |..........OO.O.......O...........................|
// |.............O..OOOOOO...........................|
// |.............O.O.................................|
// |............OO.O..OOOOOO.........................|
// |...............O.O......O........................|
// |...............O.O..OOOOO........................|
// |................OO.O.......O.....................|
// |...................O..OOOOOO.....................|
// |...................O.O...........................|
// |..................OO.O..OOOOOO...................|
// |.....................O.O......O..................|
// |.....................O.O..OOOOO..................|
// |......................OO.O.......O...............|
// |.........................O..OOOOOO...............|
// |.........................O.O.....................|
// |........................OO.O..OOOOOO.............|
// |...........................O.O......O............|
// |...........................O.O..OOOOO............|
// |............................OO.O.......O.........|
// |...............................O..OOOOOO.........|
// |...............................O.O...............|
// |..............................OO.O..OOOOOO.......|
// |.................................O.O......O......|
// |.................................O.O..OOOOO......|
// |..................................OO.O.......O...|
// |.....................................O..OOOOOO...|
// |.....................................O.O.........|
// |....................................OO.O..OOOOOO.|
// |.......................................O.O......O|
// |.......................................O.O..OOO.O|
// |........................................OO.O...O.|
// |...........................................O..O..|
// |...........................................O.O...|
// |..........................................OO.O.O.|
// |..............................................OO.|
// `),
// 		"4-boats": parsePattern("4 Boats", `
// |...O....|
// |..O.O...|
// |.O.OO...|
// |O.O..OO.|
// |.OO..O.O|
// |...OO.O.|
// |...O.O..|
// |....O...|
// `),
// 		"44P5H2V0": parsePattern("44P5H2V0", `
// |....O.....O....|
// |...OOO...OOO...|
// |..O..O...O..O..|
// |.OOO.......OOO.|
// |..O.O.....O.O..|
// |....OO...OO....|
// |O....O...O....O|
// |.....O...O.....|
// |OO...O...O...OO|
// |..O..O...O..O..|
// |....O.....O....|
// `),
// 		"acorn": parsePattern("Acorn", `
// |.O.....|
// |...O...|
// |OO..OOO|
// `),
// 		"arm": parsePattern("Arm", `
// |............OOO............|
// |...........O...............|
// |..........OO...............|
// |....O.OO..OO..OOO..........|
// |...OO.OO.OO.....O....OO....|
// |..O..OO...O.OO....OO.OO....|
// |........OOOO......OO...O...|
// |....O.O.OO........OO.......|
// |......O....................|
// |...OO......................|
// |..OO..O....................|
// |....OOO.OO.................|
// |O..O.....OOO...............|
// |.O.OOOO.O...O..............|
// |........OO....O......O.....|
// |.........O....OO....OO.OOO.|
// |........O...O..OO..OO.....O|
// |..........O..O.O..O.....OO.|
// |...........O.OOO....O......|
// |............OOO..OOO.O.....|
// |...........OO...OOO........|
// |..................O..O.....|
// |...................O.......|
// `),
// 		"baker": parsePattern("Baker", `
// |..............OO|
// |.............O.O|
// |............O...|
// |...........O....|
// |..........O.....|
// |.........O......|
// |........O.......|
// |.......O........|
// |......O.........|
// |.....O..........|
// |....O...........|
// |...O............|
// |OOO.............|
// |.O..............|
// `),
// 		"biclock": parsePattern("Biclock", `
// |..O....|
// |OO.....|
// |..OO...|
// |.O...O.|
// |...OO..|
// |.....OO|
// |....O..|
// `),
// 		"bi-gun": parsePattern("Bi-Gun", `
// |...........O......................................|
// |..........OO......................................|
// |.........OO.......................................|
// |..........OO..OO..................................|
// |......................................O...........|
// |......................................OO........OO|
// |.......................................OO.......OO|
// |..........OO..OO..................OO..OO..........|
// |OO.......OO.......................................|
// |OO........OO......................................|
// |...........O......................................|
// |..................................OO..OO..........|
// |.......................................OO.........|
// |......................................OO..........|
// |......................................O...........|
// `),
// 		"blinker-puffer": parsePattern("Blinker Puffer", `
// |...O.....|
// |.O...O...|
// |O........|
// |O....O...|
// |OOOOO....|
// |.........|
// |.........|
// |.........|
// |.OO......|
// |OO.OOO...|
// |.OOOO....|
// |..OO.....|
// |.........|
// |.....OO..|
// |...O....O|
// |..O......|
// |..O.....O|
// |..OOOOOO.|
// `),
// 		"copperhead": parsePattern("Copperhead", `
// |..OOOO..|
// |........|
// |..O..O..|
// |.O.OO.O.|
// |.O....O.|
// |........|
// |.O....O.|
// |.OO..OO.|
// |.OOOOOO.|
// |..O..O..|
// |...OO...|
// |...OO...|
// `),
// 		"demultiplexer": parsePattern("Demultiplexer", `
// |...........................O.....|
// |........OO.................O.O...|
// |.........O.................OO....|
// |.........O.O.....................|
// |..........OO.....................|
// |.......................OO........|
// |.......................O.O.......|
// |........................O........|
// |.................................|
// |.................................|
// |.............................OO..|
// |..........O..................O.O.|
// |..........O.O..................O.|
// |..........OOO............OO....OO|
// |............O............O.O.....|
// |...........................O.....|
// |...........................OO....|
// |.................................|
// |.................................|
// |..OO.............................|
// |.O.O.............................|
// |.O...............................|
// |OO...............................|
// `),
// 		"glider": parsePattern("Glider", `
// |..O|
// |O.O|
// |.OO|
// `),
// 		"gosper-glider-gun": parsePattern("Gosper Glider Gun", `
// |........................O...........|
// |......................O.O...........|
// |............OO......OO............OO|
// |...........O...O....OO............OO|
// |OO........O.....O...OO..............|
// |OO........O...O.OO....O.O...........|
// |..........O.....O.......O...........|
// |...........O...O....................|
// |............OO......................|
// `),
// 		"heavy-weight-spaceship": parsePattern("Heavy Weight Spaceship", `
// |..OO...|
// |O....O.|
// |......O|
// |O.....O|
// |.OOOOOO|
// `),
// 		"light-weight-spaceship": parsePattern("Light Weight Spaceship", `
// |.OOOO|
// |O...O|
// |....O|
// |O..O.|
// `),
// 		"middle-weight-spaceship": parsePattern("Middle Weight Spaceship", `
// |..O...|
// |O...O.|
// |.....O|
// |O....O|
// |.OOOOO|
// `),
// 		"noahs-ark": parsePattern("Noah's Ark", `
// |..........O.O..|
// |.........O.....|
// |..........O..O.|
// |............OOO|
// |...............|
// |...............|
// |...............|
// |...............|
// |...............|
// |.O.............|
// |O.O............|
// |...............|
// |O..O...........|
// |..OO...........|
// |...O...........|
// `),
// 		"pentadecathlon": parsePattern("Pentadecathlon", `
// |..O....O..|
// |OO.OOOO.OO|
// |..O....O..|
// `),
// 		"pi-heptomino": parsePattern("pi-Heptomino", `
// |OOO|
// |O.O|
// |O.O|
// `),
// 		"queen-bee-shuttle": parsePattern("Queen Bee Shuttle", `
// |.........O............|
// |.......O.O............|
// |......O.O.............|
// |OO...O..O.............|
// |OO....O.O.............|
// |.......O.O........OO..|
// |.........O........O.O.|
// |....................O.|
// |....................OO|
// `),
// 		"r-pentomino": parsePattern("r-Pentomino", `
// |.OO|
// |OO.|
// |.O.|
// `),
// 		"switch-engine": parsePattern("Switch Engine", `
// |.O.O..|
// |O.....|
// |.O..O.|
// |...OOO|
// `),
// 	}
// }
